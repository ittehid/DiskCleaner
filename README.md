# Disk Cleaner

![.NET](https://img.shields.io/badge/.NET-4.8-512BD4?logo=dotnet)
![Windows](https://img.shields.io/badge/Windows-0078D6?logo=windows)
![Console App](https://img.shields.io/badge/Console_App-4EA94B)

Утилита для автоматического управления дисковым пространством с двухэтапной системой очистки. 
Программа безопасно перемещает старые файлы в резервную зону, а затем удаляет их только при реальной нехватке места.

## 🚀 Возможности

- **Двухэтапная очистка** - сначала перемещение в резерв, потом удаление при нехватке места
- **Безопасное хранение** - файлы не удаляются сразу, а сохраняются в резервной папке
- **Контроль времени** - перемещает только файлы старше заданного времени (по умолчанию 30 минут)
- **Структурированный резерв** - сохраняет оригинальную структуру папок в резервной зоне
- **Автоматический мониторинг** заполненности диска
- **Умная логика** - удаляет самые старые файлы из резерва по дате создания
- **Подробное логирование** с разделением по дням
- **Гибкая настройка** через конфигурационный файл
- **Автоочистка** старых логов

## ⚙️ Установка и настройка

### Требования
- .NET Framework 4.8 или выше
- Windows 7/8/10/11 или Windows Server

### Установка
1. Скачайте последнюю версию
2. Распакуйте архив в нужную папку
3. При первом запуске автоматически создастся файл конфигурации

### Настройка
Отредактируйте файл `disk_cleaner_config.json`:

```json
{
  "MonitorFolders": [
    "C:\\Канал-1",
    "C:\\Канал-2",
    "D:\\Логи"
  ],
  "ReserveFolder": "C:\\#REZERV#",
  "FileMinAgeMinutes": 30,
  "DiskUsageThreshold": 80,
  "LogRetentionDays": 10
}
```

**MonitorFolders**  - список папок для мониторинга и перемещения файлов
**ReserveFolder**  - резервная папка для временного хранения файлов
**FileMinAgeMinutes**  - минимальный возраст файла для перемещения (в минутах)
**DiskUsageThreshold** - порог заполненности диска для очистки резерва (в процентах)
**LogRetentionDays**  - срок хранения логов (в днях)

### Логирование
- Логи сохраняются в папку `logs/`
- Каждый день создается новый файл: `disk_cleaner_dd-MM-yyyy.log`
- Старые логи автоматически удаляются через 10 дней (настраивается)

### 🔧 Как это работает

**Этап 1: Перемещение в резерв**
- Программа сканирует папки из `MonitorFolders`
- Находит файлы, которые существуют дольше `FileMinAgeMinutes` минут
- Перемещает их в резервную папку, сохраняя структуру:
```
C:\Канал-1\file.txt → C:\#REZERV#\Канал-1\file.txt
C:\Канал-2\data.log → C:\#REZERV#\Канал-2\data.log
```

**Этап 2: Очистка резерва**
1. Проверяет заполненность системного диска
2. Если заполненность превышает `DiskUsageThreshold`:
- Сканирует резервную папку `#REZERV#`
- Находит самые старые файлы по дате создания
- Удаляет их до достижения целевого порога заполненности
3. Весь процесс подробно логируется

### ⚠️ Предупреждение
Программа перемещает и удаляет файлы! Убедитесь, что:
- Указанные в `MonitorFolders` папки не содержат критически важных файлов
- Файлы успевают обработаться до перемещения (настройте `FileMinAgeMinutes`)
Резервная папка `#REZERV#` имеет достаточное место для временного хранения

**Резервная копия важных данных рекомендуется перед использованием!**